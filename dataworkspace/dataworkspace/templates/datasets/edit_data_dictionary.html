{% extends '_main.html' %}
{% load static datasets_tags core_tags waffle_tags %}
{% block page_title %}Edit data dictionary - {{ block.super }}{% endblock %}
{% block breadcrumbs %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-three-quarters">
      <div class="govuk-breadcrumbs">
        <ol class="govuk-breadcrumbs__list">
          <li class="govuk-breadcrumbs__list-item">
            <a class="govuk-breadcrumbs__link" href="/">Home</a>
          </li>
          <li class="govuk-breadcrumbs__list-item">
            <a class="govuk-breadcrumbs__link" href="{{ source.dataset.get_absolute_url }}">
              {{ dataset.name }}
            </a>
          </li>
          <li class="govuk-breadcrumbs__list-item">
            <a href="{% url "datasets:data_dictionary" dataset_uuid=dataset.id source_uuid=source_table.id %}"
            class="govuk-link govuk-link--no-visited-state">
            Data dictionary
            </a>
          </li>
          <li class="govuk-breadcrumbs__list-item">Edit data dictionary</li>
        </ol>
      </div>
    </div>
  </div>
{% endblock %}
{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">Edit data dictionary</h1>
    </div>
  </div>
  {% block success_banner %}{% endblock %}
  <div class="govuk-grid-row govuk-!-margin-top-6" id="update">
    <div class="govuk-grid-column-full">
        <form method="post">
            <div style="position:sticky;background-color:white;overflow:hidden;top:30px" class="govuk-!-padding-top-4">
                <p class="govuk-body govuk-body-m" style="float:left">
                    "{{ source_table.schema }}"."{{ source_table.table }}"
                  </p>
            <div class="govuk-button-group" style="float:right">
                <a href="{% url "datasets:data_dictionary" dataset_uuid=dataset.id source_uuid=source_table.id %}"
                class="govuk-link govuk-link--no-visited-state">
                Cancel changes
                </a>
                <button class="govuk-button" type="submit">
                    Save changes
                </button>
            </div>
            </div>
        {% csrf_token %}
      <table class="govuk-table">
        <thead>
        <tr class="govuk-table__row">
          <th class="govuk-table__header">Name</th>
          <th class="govuk-table__header">Format</th>
          <th class="govuk-table__header">Definition</th>
        </tr>
        </thead>
        <tbody>
            {% for name, data_type, definition in dictionary %}
            <tr class="govuk-table__row">
                    <th scope="row" class="govuk-table__header js-schema-column-{{ forloop.counter }}">{{ name }}</th>
                <td class="govuk-table__cell">
                    {{ data_type }}
                </td>
                <td class="govuk-table__cell">
                    <div class="govuk-form-group">
                        <textarea class="govuk-textarea" id="field_{{ name }}" name="{{ name }}" rows="5" maxlength="1024" aria-describedby="more-detail-hint">{{ definition.description }}</textarea>
                    </div>
                    {{ form.definition }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
      </table>
    </form>
    </div>
  </div>

{% endblock content %}