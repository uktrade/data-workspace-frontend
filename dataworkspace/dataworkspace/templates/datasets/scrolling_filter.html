{% with id=widget.attrs.id %}
  <div class="filter-widget">
    <div class="govuk-form-group">
      <fieldset{% if id %} id="{{ id }}"{% endif %} class="govuk-fieldset">
        <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
          <h3 class="govuk-fieldset__heading">{{ widget.group_label }}</h3>
        </legend>
        {% if widget.hint_text %}
          <span id="{{ id }}-hint" class="govuk-hint">
        {{ widget.hint_text }}
      </span>
        {% endif %}
        {% if widget.selected_count %}
          <span id="{{ id }}-selected-count" class="govuk-hint">
          {{ widget.selected_count }} selected</span>
        {% endif %}

        <div class="search-container govuk-!-margin-bottom-4">
          <input class="govuk-input" type="search" id="filter_text_{{ id }}"
                 data-target="filter_text_target_{{ id }}"
                 data-module="filter-search" />
        </div>

        <div class="filter-container filter-container__scrolling">
          <div class="govuk-checkboxes" id="filter_text_target_{{ id }}">
            {% for group, options, index in widget.optgroups %}
              {% for option in options %}
                {% include option.template_name with widget=option hidden=False %}
              {% endfor %}
            {% endfor %}
          </div>
        </div>
      </fieldset>
    </div>
    <hr class="govuk-section-break govuk-section-break--visible"/>
  </div>
{% endwith %}
